# 设计评审工作流

## 单文档评审

载入：项目 memory + 目标文档 + 相关 GDD 文档

### 检查项

**1. GDD 对齐**
- 技术方案是否满足对应 GDD 系统的设计需求？
- 是否支持 `gdd/vision/pillars.md` 中的设计支柱？
- 是否支持 `gdd/vision/core-loop.md` 中的核心循环？
- 有没有技术限制会迫使游戏设计妥协？

**2. 完整性**
- 是否有 `[TODO]` 或占位符未展开？
- 核心模块和接口是否都有说明？
- 异常情况和边界条件是否覆盖？
- 性能约束是否明确？

**3. 一致性**
- 与其他架构文档是否自洽（接口、数据流、命名）？
- 协议定义与前后端架构是否一致？
- 术语是否与 `gdd/shared/glossary.md` 一致？

**4. 可行性**
- 实现复杂度是否合理？有没有过度设计？
- 技术选型是否成熟稳定？
- 是否有明显的性能瓶颈或扩展性风险？

**5. 可测试性**
- 架构是否支持 `testing/strategy.md` 中定义的测试方案？
- 模块间耦合度是否影响单元测试？
- 关键路径是否可自动化测试？

## 跨文档评审

载入：项目 memory +（使用 subagent 并行读取多个文档）

### 检查项

1. 前端架构与服务端架构之间的接口是否对齐？
2. 协议定义是否覆盖所有需要通信的场景？
3. 数据模型在前后端是否一致？
4. 代码结构是否反映了架构设计的模块划分？
5. 编码规范是否与技术栈选型匹配？
6. 测试策略是否覆盖了架构中的关键路径？
7. `gdd-mapping.md` 是否与实际架构模块对应？

## 整体架构评审

在所有子文档基本完成后，进行一次全面评审：

### 使用 Subagent 并行检查

启动多个 subagent 分别检查：
- **Subagent 1**：GDD 对齐检查（读取 GDD vision + 所有 architecture 文档）
- **Subagent 2**：一致性检查（读取所有 architecture + code-structure + protocols 文档）
- **Subagent 3**：可行性检查（读取 tech-stack + architecture 文档）

汇总各 subagent 的检查结果，统一输出评审报告。

## 输出格式

```markdown
## 评审报告: <范围>
日期: YYYY-MM-DD

### 关键问题（必须解决）
- **问题**: 描述 | **位置**: 文件§章节 | **建议**: 解决方案

### 建议改进
- **问题**: 描述 | **位置**: 文件§章节 | **建议**: 改进方案

### 亮点
- 设计得好的部分及原因

### 待讨论
- 需要与用户讨论才能定论的技术决策
```

## 评审后操作

- 关键问题 → 写入 `memory/project.md`「待解决」
- 新的技术债务 → 写入 `memory/project.md`「技术债务」
- 更新 `memory/project.md`「回顾」记录
- 如用户同意修改 → 切换到设计文档模式执行
